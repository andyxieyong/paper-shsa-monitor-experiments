Scripts
=======


Plot logged bag file
--------------------

```bash
$ x11docker --homedir /path/to/paper-shsa-monitor-experiments/ \
    paper:shsa-prolog -- ~/scripts/plt_log.py ~/log/latest.bag
```

Fault injection to logged bag file
----------------------------------

Convert logged ROS data (bag file created with log.launch)
to a pickle file that can be fed to the monitor via the `run.py` script.
It converts input signal messages to a list of `Itom` objects that can be subsequently checked by the monitor.
```bash
$ docker run --rm -it -v /path/to/paper-shsa-monitor-experiments/:/catkin_ws/src/demo \
    paper:shsa-prolog -- /catkin_ws/src/demo/scripts/bag_to_itoms.py -h
```

Fault injection:
```bash
$ docker run --rm -it -v /path/to/paper-shsa-monitor-experiments/:/catkin_ws/src/demo \
    paper:shsa-prolog -- /catkin_ws/src/demo/scripts/fault_injection.py -h
```

Run monitor stand-alone (without ROS)
-------------------------------------

```bash
$ docker run --rm -it -v /path/to/paper-shsa-monitor-experiments/:/catkin_ws/src/demo \
    paper:shsa-prolog /catkin_ws/src/demo/scripts/run.py -h
```

Pass a pickle object file generated by `bag_to_itoms.py` (and optional fault injection) to the script.

Plot monitor output
-------------------

```bash
$ x11docker --homedir /path/to/paper-shsa-monitor-experiments/ paper:shsa-prolog -- \
    ~/scripts/plt_run.py -e ~/scripts/fig.pdf ~/scripts/latest.bag.obj
```

Experiments in the Paper
------------------------

Execute the `ex_*.sh` scripts and plot.
```bash
# monitor on rover logs
$ ./ex_monitorlog.sh
$ x11docker --homedir /path/to/paper-shsa-monitor-experiments/ paper:shsa-prolog -- ~/scripts/plt_run.py -u ~/config/uncertainty.yaml -p ~/scripts/run.obj
# generic value
$ ./ex_generic_value.sh
$ x11docker --homedir /path/to/paper-shsa-monitor-experiments/ paper:shsa-prolog -- ~/scripts/plt_generic_value.py -u ~/config/generic.yaml -p ~/scripts/run.obj
# generic time
$ ./ex_generic_time.sh
$ x11docker --homedir /path/to/paper-shsa-monitor-experiments/ paper:shsa-prolog -- ~/scripts/plt_generic_time.py -u ~/config/generic.yaml -p ~/scripts/run_gt1.obj ~/scripts/run_gt2.obj
```
